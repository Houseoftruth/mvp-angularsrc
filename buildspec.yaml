version: 0.2


phases:
  pre_build:
    commands:
      - npm install
      - pip install --user aws-sam-cli  

  build:
    commands:
      - USER_BASE_PATH=$(python -m site --user-base)
      - export PATH=$PATH:$USER_BASE_PATH/bin
      - sam build -t cloudformation.yml
  post_build:
    commands:
      - echo $AWS_ACCESS_ID
      - printf '{"ImageURI":"image_URI"}' > imageDetail.json
      - aws s3api list-buckets --query "Buckets[].Name"
      - aws s3 sync ./ s3://mvp-src-dev --acl 'public-read' --delete
      